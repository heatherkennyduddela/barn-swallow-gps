# barn-swallow-gps

This file contains details about the data processing and analysis for relating GPS movement data of female barn swallows to their extra-pair mating outcomes in terms of the proportion of extra-pair young in their clutch, and the number of sires represented in each clutch. 

The steps described require the following software: 

* R and RStudio

For details about processing genomic data and caclulating pairwise relatedness, see the README file in the `genomic-workflow` folder. 

## Contents

* [Process spatial data from GPS tags](#spatial-data)
* [Paternity assignment using relatedness]
* Models and hypothesis testing

### Processing GPS Data

Raw GPS data can be downloaded from MoveBank. The GPS data used for this projet and posted to this repository has been filtered to only include valid fixes and those with high horizontal accuracy (HDOP > 5). Raw data also includes a reference fix that was taken prior to deployment. Those reference points have been removed from the data provided here. 


Use the script `KDE with adehabitatHR` to calculate 50% and 90% kernel density estimator areas, and the proportion of points within 50 and 100m of the home barn. The script takes the following input data: 

* `GPS points all sites.csv`
* `barns.csv`


Use the script `est-max-dist.R` to calculate the estimated maximum distance traveled for each bird. This script downsamples to the fewest number of GPS points per bird (60), and repeatedly takes random samples of 60 points for each bird to calculate the estimated maximum distance. The final distance estimates are the average for each bird across 100 replicats. This script takes the following input data: 

* `point.distance.hkd.csv` generated by the `KDE with adehabitatHR.R` script





